---
title: "Foundations of Probability and Statistics, Project"
author: "Emiliano Capasso, Antonello Scarcella, Simone Bellavia"
date: '2022-12-05'
geometry: "left=2cm,right=2cm,top=0.5cm,bottom=1.5cm"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning=FALSE,
                      message=FALSE,
                      tidy.opts=list(width.cutoff = 80),
                      tidy = TRUE)
library(tidyverse) # for tidyverse
library(tidymodels) # for tidymodels
library(class) # for knn
library(caret) # for createDataPartition
library(psych) # for dummy.code
library(fastDummies) # for dummy_cols()
library(e1071) # for Naive Bayes
library(pROC)  # for ROC curve
library(gmodels) # for CrossTable
library(performance) #Â for compare_performance
library(tree) # for Decision Trees
library(ggplot2) # for plots
library(reshape2) # for melt function
```

# Introduction to Analysis

TBD

# Descriptive Analysis

TBD

## Importing data

```{r}
# import data
data <- read.csv("data.csv", 
                    header=TRUE)
```

## First exploration

```{r}
# get structure of dataset
str(data)
```

- id: id number
- diagnosis (response): the diagnosis of breast tissues (M = malignant, B = benign)
- radius_mean: mean of distances from center to points on the perimeter
- texture_mean: standard deviation of gray-scale values
- perimeter_mean: mean size of the core tumor
- area_mean: //
- smoothness_mean: mean of local variation in radius lengths
- compactness_mean: mean of perimeter^2 / area - 1.0
- concavity_mean: mean of severity of concave portions of the contour
- concave points_mean: mean for number of concave portions of the contour
- ecc.

```{r}
# get summary of variables
summary(data)
```

```{r}
# getting the head of dataset
head(data)
```

## Missing Values

Checking if there are missing values:

```{r}
# check for missing values
colSums(is.na(data))
```

There aren't missing values in the considered dataset, except for 32th feature 'X' that is full of NA, we drop it.

```{r}
data <- data %>% select(-X)
```

We also drop id because it is not needed

```{r}
data <- data %>% select(-id)
```

Checking if the column has been dropped.

```{r}
colnames(data)
```

## Second exploration

```{r}
describe(data)
```

Let's see the frequency of cancer diagnosis (if benignant or malignant)

```{r}
ggplot(data, aes(x = diagnosis)) + 
  geom_bar(aes(y = (..count..)/sum(..count..))) + 
  labs(x = "Diagnosis", y = "Frequency", title = "Frequency of Cancer Stages")
```

Benignant cancers are way more than malignant.

Let's see the correlation map with a heatmap.

```{r}
# Remove non-numeric columns
numeric_data <- data[, sapply(data, is.numeric)]

# Create correlation matrix
corr_matrix <- cor(numeric_data)

# Create heatmap
library(ggplot2)
library(reshape2)
melted_matrix <- melt(corr_matrix)
ggplot(data = melted_matrix, aes(x = Var1, y = Var2, fill = value)) +
  geom_tile(color = "white") +
  scale_fill_gradient2(low = "blue", high = "red", mid = "white",
                       midpoint = 0, limit = c(-1,1), name = "Correlation") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  ggtitle("Correlation Map")
```

# Tests

TBD

# Linear Model

TBD

# Bibliography

[1] TBD